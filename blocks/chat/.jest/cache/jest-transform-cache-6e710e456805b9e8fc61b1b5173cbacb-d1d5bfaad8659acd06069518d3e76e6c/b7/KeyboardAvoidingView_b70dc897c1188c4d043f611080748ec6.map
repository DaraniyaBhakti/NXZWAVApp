{"version":3,"names":["_interopRequireDefault","require","_extends2","_objectWithoutProperties2","_classCallCheck2","_createClass2","_inherits2","_possibleConstructorReturn2","_getPrototypeOf2","_excluded","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","default","result","NewTarget","constructor","Reflect","construct","arguments","apply","sham","Proxy","Boolean","prototype","valueOf","call","e","Keyboard","LayoutAnimation","Platform","React","StyleSheet","View","KeyboardAvoidingView","_React$Component","_super","props","_this","_frame","_subscriptions","_initialFrameHeight","_onKeyboardChange","event","setState","bottom","duration","easing","endCoordinates","height","_relativeKeyboardHeight","state","configureNext","update","type","Types","_onLayout","nativeEvent","layout","viewRef","createRef","key","value","keyboardFrame","frame","keyboardY","screenY","keyboardVerticalOffset","Math","max","y","componentDidMount","OS","addListener","componentWillUnmount","forEach","subscription","remove","render","_this$props","behavior","children","contentContainerStyle","enabled","style","bottomHeight","heightStyle","flex","createElement","ref","compose","onLayout","paddingBottom","Component","defaultProps","module","exports"],"sources":["KeyboardAvoidingView.js"],"sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @format\n * @flow\n */\n\n'use strict';\n\nconst Keyboard = require('./Keyboard');\nconst LayoutAnimation = require('../../LayoutAnimation/LayoutAnimation');\nconst Platform = require('../../Utilities/Platform');\nconst React = require('react');\nconst StyleSheet = require('../../StyleSheet/StyleSheet');\nconst View = require('../View/View');\n\nimport type {ViewStyleProp} from '../../StyleSheet/StyleSheet';\nimport type EmitterSubscription from '../../vendor/emitter/EmitterSubscription';\nimport type {\n  ViewProps,\n  ViewLayout,\n  ViewLayoutEvent,\n} from '../View/ViewPropTypes';\nimport type {KeyboardEvent} from './Keyboard';\n\ntype Props = $ReadOnly<{|\n  ...ViewProps,\n\n  /**\n   * Specify how to react to the presence of the keyboard.\n   */\n  behavior?: ?('height' | 'position' | 'padding'),\n\n  /**\n   * Style of the content container when `behavior` is 'position'.\n   */\n  contentContainerStyle?: ?ViewStyleProp,\n\n  /**\n   * Controls whether this `KeyboardAvoidingView` instance should take effect.\n   * This is useful when more than one is on the screen. Defaults to true.\n   */\n  enabled: ?boolean,\n\n  /**\n   * Distance between the top of the user screen and the React Native view. This\n   * may be non-zero in some cases. Defaults to 0.\n   */\n  keyboardVerticalOffset: number,\n|}>;\n\ntype State = {|\n  bottom: number,\n|};\n\n/**\n * View that moves out of the way when the keyboard appears by automatically\n * adjusting its height, position, or bottom padding.\n */\nclass KeyboardAvoidingView extends React.Component<Props, State> {\n  static defaultProps: $TEMPORARY$object<{|\n    enabled: boolean,\n    keyboardVerticalOffset: number,\n  |}> = {\n    enabled: true,\n    keyboardVerticalOffset: 0,\n  };\n\n  _frame: ?ViewLayout = null;\n  _subscriptions: Array<EmitterSubscription> = [];\n  viewRef: {current: React.ElementRef<any> | null};\n  _initialFrameHeight: number = 0;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {bottom: 0};\n    this.viewRef = React.createRef();\n  }\n\n  _relativeKeyboardHeight(keyboardFrame): number {\n    const frame = this._frame;\n    if (!frame || !keyboardFrame) {\n      return 0;\n    }\n\n    const keyboardY = keyboardFrame.screenY - this.props.keyboardVerticalOffset;\n\n    // Calculate the displacement needed for the view such that it\n    // no longer overlaps with the keyboard\n    return Math.max(frame.y + frame.height - keyboardY, 0);\n  }\n\n  _onKeyboardChange = (event: ?KeyboardEvent) => {\n    if (event == null) {\n      this.setState({bottom: 0});\n      return;\n    }\n\n    const {duration, easing, endCoordinates} = event;\n    const height = this._relativeKeyboardHeight(endCoordinates);\n\n    if (this.state.bottom === height) {\n      return;\n    }\n\n    if (duration && easing) {\n      LayoutAnimation.configureNext({\n        // We have to pass the duration equal to minimal accepted duration defined here: RCTLayoutAnimation.m\n        duration: duration > 10 ? duration : 10,\n        update: {\n          duration: duration > 10 ? duration : 10,\n          type: LayoutAnimation.Types[easing] || 'keyboard',\n        },\n      });\n    }\n    this.setState({bottom: height});\n  };\n\n  _onLayout = (event: ViewLayoutEvent) => {\n    this._frame = event.nativeEvent.layout;\n    if (!this._initialFrameHeight) {\n      // save the initial frame height, before the keyboard is visible\n      this._initialFrameHeight = this._frame.height;\n    }\n  };\n\n  componentDidMount(): void {\n    if (Platform.OS === 'ios') {\n      this._subscriptions = [\n        Keyboard.addListener('keyboardWillChangeFrame', this._onKeyboardChange),\n      ];\n    } else {\n      this._subscriptions = [\n        Keyboard.addListener('keyboardDidHide', this._onKeyboardChange),\n        Keyboard.addListener('keyboardDidShow', this._onKeyboardChange),\n      ];\n    }\n  }\n\n  componentWillUnmount(): void {\n    this._subscriptions.forEach(subscription => {\n      subscription.remove();\n    });\n  }\n\n  render(): React.Node {\n    const {\n      behavior,\n      children,\n      contentContainerStyle,\n      enabled,\n      keyboardVerticalOffset,\n      style,\n      ...props\n    } = this.props;\n    const bottomHeight = enabled ? this.state.bottom : 0;\n    switch (behavior) {\n      case 'height':\n        let heightStyle;\n        if (this._frame != null && this.state.bottom > 0) {\n          // Note that we only apply a height change when there is keyboard present,\n          // i.e. this.state.bottom is greater than 0. If we remove that condition,\n          // this.frame.height will never go back to its original value.\n          // When height changes, we need to disable flex.\n          heightStyle = {\n            height: this._initialFrameHeight - bottomHeight,\n            flex: 0,\n          };\n        }\n        return (\n          <View\n            ref={this.viewRef}\n            style={StyleSheet.compose(\n              style,\n              heightStyle,\n            )}\n            onLayout={this._onLayout}\n            {...props}>\n            {children}\n          </View>\n        );\n\n      case 'position':\n        return (\n          <View\n            ref={this.viewRef}\n            style={style}\n            onLayout={this._onLayout}\n            {...props}>\n            <View\n              style={StyleSheet.compose(\n                contentContainerStyle,\n                {\n                  bottom: bottomHeight,\n                },\n              )}>\n              {children}\n            </View>\n          </View>\n        );\n\n      case 'padding':\n        return (\n          <View\n            ref={this.viewRef}\n            style={StyleSheet.compose(\n              style,\n              {paddingBottom: bottomHeight},\n            )}\n            onLayout={this._onLayout}\n            {...props}>\n            {children}\n          </View>\n        );\n\n      default:\n        return (\n          <View\n            ref={this.viewRef}\n            onLayout={this._onLayout}\n            style={style}\n            {...props}>\n            {children}\n          </View>\n        );\n    }\n  }\n}\n\nmodule.exports = KeyboardAvoidingView;\n"],"mappings":"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"}