{"version":3,"file":"/Users/macm14/Documents/NXZWAW/nxzwav-294793-react-native/src/packages/blocks/chat/__tests__/step-definitions/chat.steps.tsx","sources":["/Users/macm14/Documents/NXZWAW/nxzwav-294793-react-native/src/packages/blocks/chat/__tests__/step-definitions/chat.steps.tsx"],"names":[],"mappings":"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","sourcesContent":["import { defineFeature, loadFeature } from \"jest-cucumber\";\nimport { shallow, ShallowWrapper } from \"enzyme\";\n\nimport * as helpersChat from \"../../../../framework/src/Helpers\";\nimport { runEngine } from \"../../../../framework/src/RunEngine\";\nimport React from \"react\";\nimport Chat from \"../../src/Chat\";\nimport MessageEnum, { getName } from \"../../../../framework/src/Messages/MessageEnum\";\nimport { Message } from \"../../../../framework/src/Message\";\n\nconst screenPropsChat = {\n  navigation: {\n    navigate: jest.fn(),\n    setOptions: jest.fn(),\n    push: jest.fn(),\n    addListener: jest.fn().mockImplementation((event, callback) => {\n      callback();\n    }),\n    goBack: jest.fn(),\n    state: {\n      params: {\n        receiverUser: \"ReceiveUser\",\n        userID:\"7\",\n        userName:\"name\",\n        userPic:\"\",\n        userPoints:\"12\",\n        userRole:\"designer\"\n      },\n    },\n  },\n  id: \"Chat\",\n};\n\nconst featureChat = loadFeature(\"./__tests__/features/Chat-scenario.feature\");\n\ndefineFeature(featureChat, (test) => {\n  beforeEach(() => {\n    jest.resetModules();\n    jest.clearAllMocks();\n    jest.doMock(\"react-native\", () => ({ Platform: { OS: \"ios\" } }));\n    jest.spyOn(helpersChat, \"getOS\").mockImplementation(() => \"ios\");\n    jest.spyOn(runEngine, \"sendMessage\");\n  });\n\n  test(\"User navigates to Chat\", ({ given, when, then }) => {\n    let chatWrapper: ShallowWrapper;\n    let instanceChat: Chat;\n\n    given(\"I am a User loading Chat\", () => {\n      chatWrapper = shallow(<Chat {...screenPropsChat} />);\n    });\n\n    when(\"I navigate to Chat\", () => {\n      instanceChat = chatWrapper.instance() as Chat;\n      jest.spyOn(instanceChat, \"send\");\n      let dmSelectedChat = true;\n      instanceChat.state = {\n        // Customizable Area Start\n        token: \"\",\n        accountId: -1,\n        chatName: \"\",\n        chatList: [],\n        isVisibleModal: false,\n        dmSelected: dmSelectedChat,\n        pmSelected: !dmSelectedChat,\n        txtInputValue: \"\",\n        messageConversation: \"\",\n        // Customizable Area End\n      };\n\n      let btnBackChat = chatWrapper.findWhere(\n        (node) => node.prop(\"testID\") === \"btnBackChat\"\n      );\n      btnBackChat.simulate(\"press\");\n\n      let textInputComponentChat = chatWrapper.findWhere(\n        (node) => node.prop(\"testID\") === \"textInputComponentChat\"\n      );\n      textInputComponentChat.simulate(\"changeText\", \"user\");\n      instanceChat.onPressSubmitting()\n    });\n\n    then(\"User can select Message typ\", () => {\n      let btnDmChat = chatWrapper.findWhere(\n        (node) => node.prop(\"testID\") === \"btnDmChat\"\n      );\n      btnDmChat.simulate(\"press\");\n\n      let btnPmChat = chatWrapper.findWhere(\n        (node) => node.prop(\"testID\") === \"btnPmChat\"\n      );\n      btnPmChat.simulate(\"press\");\n      \n      let btnNewMessage = chatWrapper.findWhere(\n        (node) => node.prop(\"testID\") === \"btnNewMessage\"\n      );\n      btnNewMessage.simulate(\"press\");\n\n    });\n\n    then(\"Chat conversation will load\", () => {\n      let itemConversation = {\n        item:{\n        attributes: {\n          id: 1,\n          created_at: \"2023-05-11T13:35:01.045Z\",\n          updated_at: \"2023-05-12T11:07:19.753Z\",\n          profile_info: {\n              profile_pic: null,\n              user_name: \"Mr. Fabian Ward\"\n          },\n          message: {\n              id: 724,\n              message: \"test_message\",\n              created_at: \"2023-05-12T11:07:19.751Z\",\n              updated_at: \"2023-05-12T11:07:19.751Z\",\n              is_mark_read: true,\n              attachment: null,\n              conversation_id: 240,\n              user_profile_info_id: 475\n          }\n        },}\n      };\n      let flatListConversation = chatWrapper.findWhere(\n        (node) => node.prop(\"testID\") === \"swipeListViewConversation\"\n      );\n      let rowItemConversation = flatListConversation\n        .renderProp(\"renderItem\")(itemConversation)\n        .findWhere((node) => node.prop(\"testID\") === \"rowItemConversation\");\n      rowItemConversation.simulate(\"press\");\n\n      let rowHiddenItemMessage = flatListConversation\n        .renderProp(\"renderHiddenItem\")(itemConversation)\n        .findWhere((node) => node.prop(\"testID\") === \"rowHiddenItemMessage\");\n        rowHiddenItemMessage.simulate(\"press\");\n       // instanceChat.handleRowItemOnMessagePress(itemConversation.item)\n\n        let rowHiddenItemDelete = flatListConversation\n        .renderProp(\"renderHiddenItem\")(itemConversation)\n        .findWhere((node) => node.prop(\"testID\") === \"rowHiddenItemDelete\");\n        rowHiddenItemDelete.simulate(\"press\");\n\n        let rowItemKeyExtractor = flatListConversation\n        .renderProp(\"keyExtractor\")(itemConversation.item)\n\n        let touchOnMainContainerChat = chatWrapper.findWhere(\n          (node) => node.prop(\"testID\") === \"touchOnMainContainerChat\"\n        );\n        touchOnMainContainerChat.simulate(\"press\");\n        instanceChat.hideKeyboard();\n    });\n\n    when(\"I write in textInput and press submit\", () => {\n      instanceChat.render()\n    });\n\n    then(\"Api call and show chat list\", async() => {\n      instanceChat.setState({dmSelected:true})\n\n      instanceChat.getChatList(\"eyJhbGciOiJIUzUxMiJ9.eyJpZCI6MzIxLCJleHAiOjE3MTUzMjY3NTB9.y_MHa8FuNf5s6W9SkhcIKUCLwZdlTRajumrfzciVlBnxzmp330huF83ST449ga4SPWcMqDYAm8SjIexxxwzJAw\");\n      \n      const msgDeleteAPI = new Message(\n        getName(MessageEnum.RestAPIResponceMessage)\n      );\n      msgDeleteAPI.addData(\n        getName(MessageEnum.RestAPIResponceDataMessage),\n        msgDeleteAPI.messageId\n      );\n      msgDeleteAPI.addData(\n        getName(MessageEnum.RestAPIResponceSuccessMessage),\n        {\n          data: {\n              message: \"Conversation Deleted\"\n          }\n        })\n        instanceChat.deleteConversationApiCallId = msgDeleteAPI.messageId;\n        runEngine.sendMessage(\"Unit Test\", msgDeleteAPI);\n    });\n\n    when(\"I click on top button\", () => {\n      \n      const messageNavigationChat = new Message(getName(MessageEnum.NavigationMessage));\n      messageNavigationChat.addData(getName(MessageEnum.NavigationPropsMessage), {\n      messageType: \"readMessage\",\n      conversationID:\"1\"\n      });\n      instanceChat.send(messageNavigationChat);\n      \n      instanceChat.setState({txtInputValue:\"ru\"})\n      instanceChat.getConversationList()\n\n      const msgGetConversations = new Message(\n        getName(MessageEnum.RestAPIResponceMessage)\n      );\n      msgGetConversations.addData(\n        getName(MessageEnum.RestAPIResponceDataMessage),\n        msgGetConversations.messageId\n      );\n      msgGetConversations.addData(\n        getName(MessageEnum.RestAPIResponceSuccessMessage),\n        {\n          data: {\n              message: \"No conversations Found\"\n          }\n        })\n        instanceChat.getConversationListApiCallId = msgGetConversations.messageId;\n        runEngine.sendMessage(\"Unit Test\", msgGetConversations);\n\n        instanceChat.deleteConversation(\"1\")\n        instanceChat.setState({dmSelected:true, pmSelected:false})\n      instanceChat.getConversationList()\n    });\n\n    then(\"it navigates on next screen\", () => {\n      instanceChat.setState({dmSelected:false, pmSelected:true})\n      instanceChat.getConversationList()\n      \n    });\n\n    then(\"I can leave the screen\", () => {\n      instanceChat.componentWillUnmount();\n    });\n  });\n});\n"]}